<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <!-- <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?571c3612023b230e8c1243489bf880cb";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    </script> -->
    <meta name="description" content="中文介绍请查看 README.md  Use React, Redux, Immutable to code Tetris. Tetris is a classic game that has always been enthusiastically implemented in various languages. There are many versions of it in Javascr">
<meta property="og:type" content="website">
<meta property="og:title" content="VestJin">
<meta property="og:url" content="http://jinmajue.site/games/react-tetris-master/README-EN.html">
<meta property="og:site_name" content="VestJin">
<meta property="og:description" content="中文介绍请查看 README.md  Use React, Redux, Immutable to code Tetris. Tetris is a classic game that has always been enthusiastically implemented in various languages. There are many versions of it in Javascr">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1Ag7CNXXXXXaoXXXXXXXXXXXX-320-483.gif">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1AdjZNXXXXXcCapXXXXXXXXXX-480-343.gif">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1kvJyOVXXXXbhaFXXXXXXXXXX-320-555.gif">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1EY7cNXXXXXXraXXXXXXXXXXX-320-399.gif">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1hGQqNXXXXXX3XFXXXXXXXXXX-640-381.gif">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1fYgzNXXXXXXnXpXXXXXXXXXX-633-358.png">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1nBf1NXXXXXagapXXXXXXXXXX-520-371.png">
<meta property="og:image" content="https://img.alicdn.com/tps/TB15z4VOVXXXXahaXXXXXXXXXXX-679-133.png">
<meta property="og:image" content="https://img.alicdn.com/tps/TB1qq7kNXXXXXacXFXXXXXXXXXX-400-186.png">
<meta property="og:image" content="https://img.alicdn.com/tfs/TB1B6ODRXXXXXXHaFXXXXXXXXXX-1920-1080.png">
<meta property="article:published_time" content="2024-09-23T00:58:46.170Z">
<meta property="article:modified_time" content="2019-05-13T10:55:36.000Z">
<meta property="article:author" content="VestJin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.alicdn.com/tps/TB1Ag7CNXXXXXaoXXXXXXXXXXXX-320-483.gif">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>VestJin</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	

    

<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
    <div class="content index py4 ">
        
          <header id="header">
  <a class="u-url u-uid" href="/">
  
    
      <img id="logo" alt class="u-logo" src="/images/logo.png" />
    
  
    <div id="title">
      <h1 class="p-name">VestJin</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="目录"><i class="fa-solid fa-bars fa-2x"></i></a>
      </li>
      <!--
     --><li><a href="/">首页</a></li><!--
   --><!--
     --><li><a href="/search/">搜索</a></li><!--
   --><!--
     --><li><a href="/categories/">分类</a></li><!--
   --><!--
     --><li><a href="/games/">Games</a></li><!--
   --><!--
     --><li><a href="/about/">关于</a></li><!--
   --><!--
     --><li><a href="/archives/">归档</a></li><!--
   --><!--
     --><li><a target="_blank" rel="noopener" href="https://github.com/vestjin">项目</a></li><!--
   -->
    </ul>
  </div>
</header>

        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  

  <div class="content" itemprop="articleBody">
      
          <h3 id="中文介绍"><a href="#中文介绍" class="headerlink" title="中文介绍"></a>中文介绍</h3><p>请查看 <a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/README.md">README.md</a></p>
<hr>
<h2 id="Use-React-Redux-Immutable-to-code-Tetris"><a href="#Use-React-Redux-Immutable-to-code-Tetris" class="headerlink" title="Use React, Redux, Immutable to code Tetris."></a>Use React, Redux, Immutable to code Tetris.</h2><hr>
<p>Tetris is a classic game that has always been enthusiastically implemented in various languages. There are many versions of it in Javascript, and using React to do Tetris has become my goal.</p>
<p>Open <a target="_blank" rel="noopener" href="https://chvin.github.io/react-tetris/?lan=en">https://chvin.github.io/react-tetris/?lan=en</a> to play!</p>
<hr>
<h3 id="Interface-preview"><a href="#Interface-preview" class="headerlink" title="Interface preview"></a>Interface preview</h3><p><img src="https://img.alicdn.com/tps/TB1Ag7CNXXXXXaoXXXXXXXXXXXX-320-483.gif" alt="Interface review"></p>
<p>This is the normal speed of recording, you can see it has a smooth experience.</p>
<h3 id="Responsive"><a href="#Responsive" class="headerlink" title="Responsive"></a>Responsive</h3><p><img src="https://img.alicdn.com/tps/TB1AdjZNXXXXXcCapXXXXXXXXXX-480-343.gif" alt="Responsive"></p>
<p>Not only refers to the screen adaptation, <code>but the change of input depending on your platform, use of the keyboard in the PC and in the phone using the touch as input</code>:</p>
<p><img src="https://img.alicdn.com/tps/TB1kvJyOVXXXXbhaFXXXXXXXXXX-320-555.gif" alt="phone"></p>
<h3 id="Data-persistence"><a href="#Data-persistence" class="headerlink" title="Data persistence"></a>Data persistence</h3><p><img src="https://img.alicdn.com/tps/TB1EY7cNXXXXXXraXXXXXXXXXXX-320-399.gif" alt="Data persistence"></p>
<p>What’s the worst can happen when you’re playing stand-alone games? Power outage. The state is stored in the <code>localStorage</code> by subscribing to <code>store.subscribe</code>, which records exactly all the state. Web page refreshes, the program crashes, the phone is dead, just re-open the connection and you can continue playing.</p>
<h3 id="Redux-state-preview-Redux-DevTools-extension"><a href="#Redux-state-preview-Redux-DevTools-extension" class="headerlink" title="Redux state preview (Redux DevTools extension)"></a>Redux state preview (<a target="_blank" rel="noopener" href="https://github.com/zalmoxisus/redux-devtools-extension">Redux DevTools extension</a>)</h3><p><img src="https://img.alicdn.com/tps/TB1hGQqNXXXXXX3XFXXXXXXXXXX-640-381.gif" alt="Redux state preview"></p>
<p>Redux manages all the state that should be stored, which is a guarantee to be persisted as mentioned above.</p>
<hr>
<p>The Game framework is the use of <a target="_blank" rel="noopener" href="https://facebook.github.io/react/">React</a> + <a target="_blank" rel="noopener" href="http://redux.js.org/">Redux</a>, together with <a target="_blank" rel="noopener" href="https://facebook.github.io/immutable-js/">Immutable.js</a>.</p>
<h2 id="1-What-is-Immutable-js"><a href="#1-What-is-Immutable-js" class="headerlink" title="1. What is Immutable.js?"></a>1. What is Immutable.js?</h2><p>Immutable is data that can not be changed once it is created. Any modification or addition to or deletion of an Immutable object returns a new Immutable object.</p>
<h3 id="Acquaintance："><a href="#Acquaintance：" class="headerlink" title="Acquaintance："></a>Acquaintance：</h3><p>Let’s look at the following code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">keyLog</span>(<span class="hljs-params">touchFn</span>) &#123;<br>  <span class="hljs-keyword">let</span> data = &#123; <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;value&#x27;</span> &#125;;<br>  <span class="hljs-title function_">f</span>(data);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data.<span class="hljs-property">key</span>); <span class="hljs-comment">// Guess what will be printed?</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>If we do not look at <code>f</code>, and do not know what it did to <code>data</code>, we can not confirm what will be printed. But if <code>data</code> is <em>Immutable</em>, you can be sure that <code>data</code> haven’t changed and <code>value</code> is printed:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">keyLog</span>(<span class="hljs-params">touchFn</span>) &#123;<br>  <span class="hljs-keyword">let</span> data = <span class="hljs-title class_">Immutable</span>.<span class="hljs-title class_">Map</span>(&#123; <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;value&#x27;</span> &#125;);<br>  <span class="hljs-title function_">f</span>(data);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;key&#x27;</span>));  <span class="hljs-comment">// value</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>JavaScript uses a reference assignment, meaning that the new object simply refers to the original object, changing the new will also affect the old:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">foo = &#123;<span class="hljs-attr">a</span>: <span class="hljs-number">1</span>&#125;;  bar = foo;  bar.<span class="hljs-property">a</span> = <span class="hljs-number">2</span>;<br>foo.<span class="hljs-property">a</span> <span class="hljs-comment">// 2</span><br></code></pre></td></tr></table></figure>
<p>Although this can save memory, when the application is complex, it can result in the state not being controllable, posing a big risk. The advantages of saving memory, in this case, become more harm than good.</p>
<p>With Immutable.js the same doesn’t happen:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">foo = <span class="hljs-title class_">Immutable</span>.<span class="hljs-title class_">Map</span>(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;);  bar = foo.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">2</span>);<br>foo.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-comment">// 1</span><br></code></pre></td></tr></table></figure>

<h3 id="Concise："><a href="#Concise：" class="headerlink" title="Concise："></a>Concise：</h3><p>In <code>Redux</code>, it’s a good practice to return a new object (array) to each <code>reducer</code>, so we often see code like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// reducer</span><br>...<br><span class="hljs-keyword">return</span> [<br>   ...oldArr.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>),<br>   newValue,<br>   ...oldArr.<span class="hljs-title function_">slice</span>(<span class="hljs-number">4</span>)<br>];<br></code></pre></td></tr></table></figure>
<p>In order modify one item in the array and return the new object (array), the code has this strange appearance above, and it becomes worse the deeper the data structure.<br>Let’s take a look at Immutable.js’s approach:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// reducer</span><br>...<br><span class="hljs-keyword">return</span> oldArr.<span class="hljs-title function_">set</span>(<span class="hljs-number">4</span>, newValue);<br></code></pre></td></tr></table></figure>
<p>Isn’t it simpler?</p>
<h3 id="About-“-”："><a href="#About-“-”：" class="headerlink" title="About “&#x3D;&#x3D;&#x3D;”："></a>About “&#x3D;&#x3D;&#x3D;”：</h3><p>We know that <code>===</code> operator for the <code>Object</code> and <code>Array</code> compares the reference to the address of the object rather than its “value comparison”, such as:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>, <span class="hljs-attr">b</span>:<span class="hljs-number">2</span>, <span class="hljs-attr">c</span>:<span class="hljs-number">3</span>&#125; === &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>, <span class="hljs-attr">b</span>:<span class="hljs-number">2</span>, <span class="hljs-attr">c</span>:<span class="hljs-number">3</span>&#125;; <span class="hljs-comment">// false</span><br>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]] === [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]; <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure>

<p>To achieve the above we could only <code>deepCopy</code> and <code>deepCompare</code> to traverse the objects, but this is not only cumbersome it also harms performance.</p>
<p>Let’s check <code>Immutable.js</code> approach!</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">map1 = <span class="hljs-title class_">Immutable</span>.<span class="hljs-title class_">Map</span>(&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>, <span class="hljs-attr">b</span>:<span class="hljs-number">2</span>, <span class="hljs-attr">c</span>:<span class="hljs-number">3</span>&#125;);<br>map2 = <span class="hljs-title class_">Immutable</span>.<span class="hljs-title class_">Map</span>(&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>, <span class="hljs-attr">b</span>:<span class="hljs-number">2</span>, <span class="hljs-attr">c</span>:<span class="hljs-number">3</span>&#125;);<br><span class="hljs-title class_">Immutable</span>.<span class="hljs-title function_">is</span>(map1, map2); <span class="hljs-comment">// true</span><br><br><span class="hljs-comment">// List1 = Immutable.List([1, 2, Immutable.List[3, 4]]);</span><br><span class="hljs-title class_">List1</span> = <span class="hljs-title class_">Immutable</span>.<span class="hljs-title function_">fromJS</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]);<br><span class="hljs-title class_">List2</span> = <span class="hljs-title class_">Immutable</span>.<span class="hljs-title function_">fromJS</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]);<br><span class="hljs-title class_">Immutable</span>.<span class="hljs-title function_">is</span>(<span class="hljs-title class_">List1</span>, <span class="hljs-title class_">List2</span>); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure>
<p>It’s smooth like a breeze blowing.</p>
<p>React has a big trick when it comes to performance tuning. It uses <code>shouldComponentUpdate()</code> to check (as the name says) if the component should be re-rendered, it returns <code>true</code> by default, which always executes the <code>render()</code> method followed by the Virtual DOM comparison.</p>
<p>If we don’t return a new object when making state updates, we would have to use <code>deepCopy</code> and <code>deepCompare</code> to calculate if the new state is equal to the previous one, the consumption of the performance is not worth it. With Immutable.js, it’s easy to compare deep structures using the method above.</p>
<p>For Tetris, imagine that the board is a <code>two-dimensional array</code>. The square that can be moved is <code>shape (also a two-dimensional array) + coordinates</code>. The superposition of the board and the box is composed of the final result of <code>Matrix</code>. The properties above are built by <code>Immutable.js</code>, through its comparison method, you can easily write <code>shouldComponentUpdate</code>. Source Code:<a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/src/components/matrix/index.js#L35">&#x2F;src&#x2F;components&#x2F;matrix&#x2F;index.js#L35</a></p>
<p>Immutable learning materials:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://facebook.github.io/immutable-js/">Immutable.js</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/camsong/blog/issues/3">Immutable Detailed and React in practice</a></li>
</ul>
<hr>
<h2 id="2-How-to-use-Immutable-js-in-Redux"><a href="#2-How-to-use-Immutable-js-in-Redux" class="headerlink" title="2. How to use Immutable.js in Redux"></a>2. How to use Immutable.js in Redux</h2><p>Goal: <code>state</code> -&gt; Immutable.<br>Important plug-ins: <a target="_blank" rel="noopener" href="https://github.com/gajus/redux-immutable">gajus&#x2F;redux-immutable</a><br>Will be provided by the original Redux combineReducers provided by the above plug-ins:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-comment">// rootReducers.js</span><br><span class="hljs-comment">// import &#123; combineReducers &#125; from &#x27;redux&#x27;; // The old method</span><br><span class="hljs-keyword">import</span> &#123; combineReducers &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux-immutable&#x27;</span>; <span class="hljs-comment">// The new method</span><br><br><span class="hljs-keyword">import</span> prop1 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./prop1&#x27;</span>;<br><span class="hljs-keyword">import</span> prop2 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./prop2&#x27;</span>;<br><span class="hljs-keyword">import</span> prop3 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./prop3&#x27;</span>;<br><br><span class="hljs-keyword">const</span> rootReducer = <span class="hljs-title function_">combineReducers</span>(&#123;<br>  prop1, prop2, prop3,<br>&#125;);<br><br><br><span class="hljs-comment">// store.js</span><br><span class="hljs-comment">// Create a store method and the same general</span><br><span class="hljs-keyword">import</span> &#123; createStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux&#x27;</span>;<br><span class="hljs-keyword">import</span> rootReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./reducers&#x27;</span>;<br><br><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(rootReducer);<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store;<br></code></pre></td></tr></table></figure>
<p>Through the new <code>combineReducers</code> the store object will be stored as an Immutable.js object, the container will be slightly different, but this is what we want:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">mapStateToProps</span> = (<span class="hljs-params">state</span>) =&gt; (&#123;<br>  <span class="hljs-attr">prop1</span>: state.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;prop1&#x27;</span>),<br>  <span class="hljs-attr">prop2</span>: state.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;prop2&#x27;</span>),<br>  <span class="hljs-attr">prop3</span>: state.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;prop3&#x27;</span>),<br>  <span class="hljs-attr">next</span>: state.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;next&#x27;</span>),<br>&#125;);<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">connect</span>(mapStateToProps)(<span class="hljs-title class_">App</span>);<br></code></pre></td></tr></table></figure>


<hr>
<h2 id="3-Web-Audio-Api"><a href="#3-Web-Audio-Api" class="headerlink" title="3. Web Audio Api"></a>3. Web Audio Api</h2><p>There are many different sound effects in the game, but in fact we keep only a reference to a sound file: <a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/build/music.mp3">&#x2F;build&#x2F;music.mp3</a>. With the help of <code>Web Audio Api</code>, you can play audio in millisecond precision, with a high frequency, which is not possible with the <code>&lt;audio&gt;</code> tag. Press the arrow keys to move the box while the game is in progress, you can hear high-frequency sound.</p>
<p><img src="https://img.alicdn.com/tps/TB1fYgzNXXXXXXnXpXXXXXXXXXX-633-358.png" alt="Web audio advanced"></p>
<p><code>WAA</code> is a new set of relatively independent interface system, the audio file has a higher processing power and more professional built-in audio effects, is the W3C recommended interface, can deal with professional “sound speed, volume, environment, sound visualization, High-frequency, sound to “ and other needs. The following figure describes the use of WAA process.</p>
<p><img src="https://img.alicdn.com/tps/TB1nBf1NXXXXXagapXXXXXXXXXX-520-371.png" alt="Process"></p>
<p>Where <code>Source</code> represents an audio source, <code>Destination</code> represents the final output. Multiple Sources compose the Destination.<br>Source Code:<a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/src/unit/music.js">&#x2F;src&#x2F;unit&#x2F;music.js</a>. To achieve ajax loading mp3, and to WAA, control the playback process.</p>
<p><code>WAA</code> is supported in the latest 2 versions of each browser(<a target="_blank" rel="noopener" href="http://caniuse.com/#search=webaudio">CanIUse</a>)</p>
<p><img src="https://img.alicdn.com/tps/TB15z4VOVXXXXahaXXXXXXXXXXX-679-133.png" alt="browser compatibility"></p>
<p>IE and Android lack support though.</p>
<p>Web Audio Api learning materials:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API">Web audio concepts and usage| MDN</a></li>
<li><a target="_blank" rel="noopener" href="http://www.html5rocks.com/en/tutorials/webaudio/intro/">Getting Started with Web Audio API</a></li>
</ul>
<hr>
<h2 id="4-Game-on-the-experience-of-optimization"><a href="#4-Game-on-the-experience-of-optimization" class="headerlink" title="4. Game on the experience of optimization"></a>4. Game on the experience of optimization</h2><ul>
<li>Experience:<ul>
<li>Press the arrow keys to move vertically and horizontally. The trigger frequency is different, the game can define the trigger frequency, instead of the original event frequency, the source code:<a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/src/unit/event.js">&#x2F;src&#x2F;unit&#x2F;event.js</a> ;</li>
<li>Left and right to move the delay can drop the speed, but when moving in the wall smaller delay; in the speed of 6 through the delay will ensure a complete horizontal movement in a row;</li>
<li>The <code>touchstart</code> and <code>mousedown</code> events are also registered for the button for responsive games. When <code>touchstart</code> occurs, <code>mousedown</code> is not triggered, and when <code>mousedown</code> occurs, the <code>mouseup</code> simulator <code>mouseup</code> will also be listened to as <code>mouseup</code>, since the mouse-removed event element can not fire. Source Code:<a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/src/components/keyboard/index.js">&#x2F;src&#x2F;components&#x2F;keyboard&#x2F;index.js</a>;</li>
<li>The <code>visibilitychange</code> event, when the page is hidden\switch, the game will not proceed, switch back and it will continue, the <code>focus</code> state has also been written into the Redux. So when playing with the phone and the phone has a <code>call</code>, the progress of the game will be saved; PC open the game do not hear any other gameover, which is a bit like <code>ios</code> application switch;</li>
<li>In the game <code>any</code> time you refresh the page, (such as the closing the tab or the end of the game) can restore the current state;</li>
<li>The only pictures used in the game are <img src="https://img.alicdn.com/tps/TB1qq7kNXXXXXacXFXXXXXXXXXX-400-186.png" alt="image">, all the rest is CSS;</li>
<li>Game compatible with Chrome, Firefox, IE9 +, Edge, etc .;</li>
</ul>
</li>
<li>Rules：<ul>
<li>You can specify the initial board (ten levels) and speed (six levels) before the start of the game;</li>
<li>100 points for 1 line, 300 points for 2 lines, 700 points for 3 lines, 1500 points for 4 lines;</li>
<li>The drop speed of the box increases with the number of rows eliminated (one level for every 20 lines);</li>
</ul>
</li>
</ul>
<hr>
<h2 id="5-Experience-in-Development"><a href="#5-Experience-in-Development" class="headerlink" title="5. Experience in Development"></a>5. Experience in Development</h2><ul>
<li><code>shouldComponentUpdate</code> is written for all react components, which on the phone causes a significant performance improvement. For Large and medium-sized applications when facing performance problems, try writing your own  <code>shouldComponentUpdate</code>, it will most probably help you.</li>
<li><code>Stateless Functional Components</code>(<a target="_blank" rel="noopener" href="https://medium.com/@joshblack/stateless-components-in-react-0-14-f9798f8b992d#.xjqnbfx4e">Stateless Functional Components</a>) has no lifecycle hooks. And because all components need to write the life cycle hook <code>shouldComponentUpdate</code>, they are not used.</li>
<li>In the <code>webpack.config.js</code> <code>devServer</code> attribute is written <code>host: &#39;0.0.0.0&#39;</code>, but you can be use in the development any other ip, not limited to localhost;</li>
<li>Redux in the <code>store</code> not only connect to the method passed to <code>container</code>, you can jump out of the component, in other documents out to do flow control (dispatch), the source code:<a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/src/control/states.js">&#x2F;src&#x2F;control&#x2F;states.js</a>；</li>
<li>Dealing with persistence in React + Redux is very convenient, as long as the redux state of storage, reducers do read in each of the initialization time.</li>
<li>By configuring <code>.eslintrc.js</code> and <code>webpack.config.js</code>, the <code>ESLint</code> test is integrated in the project. Using ESLint allows coding to be written to specifications, effectively controlling code quality. Code that does not conform to the specifications can be found through the IDE and the console at development time (or build time). reference:<a target="_blank" rel="noopener" href="https://github.com/airbnb/javascript/tree/master/react">Airbnb React&#x2F;JSX Style Guide</a>；</li>
</ul>
<hr>
<h2 id="6-Summary"><a href="#6-Summary" class="headerlink" title="6. Summary"></a>6. Summary</h2><ul>
<li>As a React hand application, in the realization of the process found a small “box” or a lot of details can be optimized and polished, this time is a test of a front-end engineers and the skill of the time carefully.</li>
<li>Optimization of the direction of both React itself, such as what state is stored by the Redux, which states to the state of the component like; and out of the framework of the product can have a lot of features to play, in order to meet your needs, these will be natural propulsion technology development of.</li>
<li>An application from scratch, the function slowly accumulate bit by bit, it will build into a high-rise, do not fear it difficult to have the idea to knock on it. ^_^</li>
</ul>
<hr>
<h2 id="7-Flowchart"><a href="#7-Flowchart" class="headerlink" title="7. Flowchart"></a>7. Flowchart</h2><p><img src="https://img.alicdn.com/tfs/TB1B6ODRXXXXXXHaFXXXXXXXXXX-1920-1080.png" alt="Flowchart"></p>
<hr>
<h2 id="8-Development"><a href="#8-Development" class="headerlink" title="8. Development"></a>8. Development</h2><h3 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span><br></code></pre></td></tr></table></figure>
<h3 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> start<br></code></pre></td></tr></table></figure>
<p>The browser will go to <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a></p>
<h3 id="multi-language"><a href="#multi-language" class="headerlink" title="multi-language"></a>multi-language</h3><p>In the <a target="_blank" rel="noopener" href="https://github.com/chvin/react-tetris/blob/master/i18n.json">i18n.json</a> is the configuration for the multi-language environment. You can change the language by passing the url parameter <code>lan</code> like this: <code>https://chvin.github.io/react-tetris/?lan=en</code></p>
<h3 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">npm <span class="hljs-built_in">run</span> build<br></code></pre></td></tr></table></figure>

<p>Will build the application in the build folder.</p>

        
  </div>
</article>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021-2024
    VestJin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/games/">Games</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/vestjin">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?571c3612023b230e8c1243489bf880cb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'cactus-1';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
